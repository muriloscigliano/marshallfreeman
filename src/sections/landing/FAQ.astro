---
import { landingData } from '@data/landing';

const { faq } = landingData;
---

<section id={faq.id} class="faq" aria-labelledby="faq-headline">
  <div class="faq__container container">
    <header class="faq__header">
      <span class="faq__tagline">{faq.tagline}</span>
      <h2 id="faq-headline" class="faq__headline">
        {faq.headline}
      </h2>
    </header>

    <dl class="faq__list">
      {faq.items.map((item, index) => (
        <div class="faq__item">
          <dt class="faq__question">
            <button
              type="button"
              class="faq__trigger"
              aria-expanded="false"
              aria-controls={`faq-answer-${index}`}
              data-faq-trigger
            >
              <span class="faq__question-text">{item.question}</span>
              <span class="faq__icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <line x1="12" y1="5" x2="12" y2="19" class="faq__icon-vertical" />
                  <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
              </span>
            </button>
          </dt>
          <dd
            id={`faq-answer-${index}`}
            class="faq__answer"
            hidden
          >
            <p class="faq__answer-text">{item.answer}</p>
          </dd>
        </div>
      ))}
    </dl>
  </div>
</section>

<style>
  .faq {
    padding-block: var(--space-4xl);
    background: var(--color-foreground);
  }

  .faq__header {
    text-align: center;
    margin-bottom: var(--space-3xl);
  }

  .faq__tagline {
    display: block;
    font-size: var(--text-sm);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-text-muted);
    margin-bottom: var(--space-md);
  }

  .faq__headline {
    font-size: var(--text-4xl);
    font-weight: var(--font-weight-bold);
    letter-spacing: -0.02em;
  }

  .faq__list {
    max-width: 700px;
    margin-inline: auto;
  }

  .faq__item {
    border-bottom: 1px solid var(--color-border);
  }

  .faq__item:first-child {
    border-top: 1px solid var(--color-border);
  }

  .faq__trigger {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--space-md);
    padding-block: var(--space-lg);
    text-align: left;
  }

  .faq__question-text {
    font-size: var(--text-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
  }

  .faq__icon {
    flex-shrink: 0;
    color: var(--color-text-muted);
    transition: transform var(--duration-base) var(--ease-out-expo);
  }

  .faq__icon-vertical {
    transition: transform var(--duration-base) var(--ease-out-expo);
    transform-origin: center;
  }

  .faq__trigger[aria-expanded='true'] .faq__icon-vertical {
    transform: scaleY(0);
  }

  .faq__answer {
    overflow: hidden;
  }

  .faq__answer[hidden] {
    display: none;
  }

  .faq__answer-text {
    font-size: var(--text-base);
    color: var(--color-text-muted);
    line-height: 1.6;
    padding-bottom: var(--space-lg);
  }
</style>

<script>
  const triggers = document.querySelectorAll('[data-faq-trigger]');

  triggers.forEach((trigger) => {
    trigger.addEventListener('click', () => {
      const isExpanded = trigger.getAttribute('aria-expanded') === 'true';
      const answerId = trigger.getAttribute('aria-controls');
      const answer = document.getElementById(answerId || '');

      // Close all other FAQs
      triggers.forEach((otherTrigger) => {
        if (otherTrigger !== trigger) {
          otherTrigger.setAttribute('aria-expanded', 'false');
          const otherAnswerId = otherTrigger.getAttribute('aria-controls');
          const otherAnswer = document.getElementById(otherAnswerId || '');
          if (otherAnswer) otherAnswer.hidden = true;
        }
      });

      // Toggle current FAQ
      trigger.setAttribute('aria-expanded', String(!isExpanded));
      if (answer) answer.hidden = isExpanded;
    });
  });
</script>
