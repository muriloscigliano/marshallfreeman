---
interface Props {
  href?: string;
  label: string;
  variant?: 'primary' | 'secondary' | 'dark' | 'light';
  size?: 'default' | 'small';
  ariaLabel?: string;
  type?: 'link' | 'submit';
  openDrawer?: string;
}

const { href, label, variant = 'primary', size = 'default', ariaLabel, type = 'link', openDrawer } = Astro.props;
const sizeClass = size === 'small' ? 'btn-animate--small' : '';

// Check if href points to #contact - make it open drawer instead
const isContactLink = href === '#contact';
const shouldOpenDrawer = openDrawer || isContactLink;
const drawerTarget = openDrawer || (isContactLink ? 'contact' : undefined);
---

{type === 'submit' ? (
  <button
    type="submit"
    aria-label={ariaLabel || label}
    class={`btn-animate btn-animate--${variant} ${sizeClass}`}
  >
    <span class="btn-animate__bg"></span>
    <span data-button-animate-chars class="btn-animate__text">{label}</span>
    <span class="btn-animate__arrow" aria-hidden="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </span>
  </button>
) : shouldOpenDrawer ? (
  <button
    type="button"
    aria-label={ariaLabel || label}
    class={`btn-animate btn-animate--${variant} ${sizeClass}`}
    data-drawer-open={drawerTarget}
  >
    <span class="btn-animate__bg"></span>
    <span data-button-animate-chars class="btn-animate__text">{label}</span>
    <span class="btn-animate__arrow" aria-hidden="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </span>
  </button>
) : (
  <a
    href={href}
    aria-label={ariaLabel || label}
    class={`btn-animate btn-animate--${variant} ${sizeClass}`}
  >
    <span class="btn-animate__bg"></span>
    <span data-button-animate-chars class="btn-animate__text">{label}</span>
    <span class="btn-animate__arrow" aria-hidden="true">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </span>
  </a>
)}

<style>
  .btn-animate {
    cursor: pointer;
    justify-content: center;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-md) var(--space-md);
    font-size: var(--text-base);
    font-weight: var(--font-weight-semibold);
    border-radius: var(--radius-sd);
    line-height: 1;
    text-decoration: none;
    display: inline-flex;
    position: relative;
    overflow: hidden;
    border: none;
    font-family: inherit;
  }

  /* Small size variant */
  .btn-animate--small {
    padding: var(--space-sm) var(--space-sm);
    font-size: var(--text-sm);
    gap: var(--space-xs);
  }

  /* Primary - Yellow background, dark text */
  .btn-animate--primary {
    color: var(--color-blue-900);
  }

  .btn-animate--primary .btn-animate__bg {
    background-color: var(--color-yellow-900);
  }

  /* Secondary - Dark background, light text */
  .btn-animate--secondary {
    color: var(--color-background);
  }

  .btn-animate--secondary .btn-animate__bg {
    background-color: var(--color-text);
  }

  /* Dark - For use on light backgrounds */
  .btn-animate--dark {
    color: var(--color-background);
  }

  .btn-animate--dark .btn-animate__bg {
    background-color: var(--color-blue-900);
  }

  /* Light - For use on dark backgrounds */
  .btn-animate--light {
    color: var(--color-blue-900);
  }

  .btn-animate--light .btn-animate__bg {
    background-color: var(--color-background);
  }

  .btn-animate__text {
    white-space: nowrap;
    line-height: 1.3;
    position: relative;
    z-index: 1;
    overflow: hidden;
    display: inline-block;
  }

  .btn-animate__text :global(span) {
    display: inline-block;
    position: relative;
    text-shadow: 0 1.3em currentColor;
    transform: translateY(0) rotate(0.001deg);
    transition: transform 0.6s cubic-bezier(0.625, 0.05, 0, 1);
  }

  .btn-animate:hover .btn-animate__text :global(span) {
    transform: translateY(-1.3em) rotate(0.001deg);
  }

  .btn-animate__arrow {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    transition: transform 0.4s cubic-bezier(0.625, 0.05, 0, 1);
  }

  .btn-animate:hover .btn-animate__arrow {
    transform: translateX(4px);
  }

  .btn-animate__bg {
    position: absolute;
    inset: 0;
    border-radius: var(--radius-sd);
    transition:
      inset 0.6s cubic-bezier(0.625, 0.05, 0, 1),
      border-radius 0.6s cubic-bezier(0.625, 0.05, 0, 1);
  }

  .btn-animate:hover .btn-animate__bg {
    inset: 3px;
    border-radius: var(--radius-sm);
  }
</style>
